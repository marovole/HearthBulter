## Why
通过全面的代码审查，发现了多个关键的安全漏洞和代码质量问题。这些问题可能导致安全风险、系统不稳定和维护困难。修复这些问题对于确保用户数据安全、提升系统可靠性和保持代码质量至关重要。

## What Changes
- **安全修复**：修复邀请系统的安全漏洞，添加邀请码过期时间验证
- **输入验证加强**：为所有API端点添加严格的输入验证机制
- **错误处理标准化**：建立统一的错误处理和响应格式
- **类型安全增强**：完善TypeScript类型定义，减少类型安全风险
- **数据库完整性**：完善软删除机制和数据完整性约束
- **代码质量提升**：消除潜在的安全隐患和代码坏味道

## Impact
- ** affected specs**: 可能需要创建新的code-quality能力规范，修改family-profile-management规范（邀请系统部分）
- ** affected code**: 主要影响API路由、数据库schema、类型定义文件和错误处理机制
- ** breaking changes**: 是，部分API响应格式可能发生变化，需要版本兼容处理
- ** security impact**: 高，修复多个安全漏洞，显著提升系统安全性