# ========================================
# HearthBulter Staging Environment Variables
# ========================================
# 复制此文件为 .env.staging 并填入真实值
# 或在Vercel项目设置中配置这些环境变量
#
# 🔐 安全提示：
# - 不要提交包含真实密钥的.env文件到Git
# - 使用强随机字符串作为密钥
# - 定期轮换敏感密钥
# ========================================

# ===== 环境标识（必需）=====
NODE_ENV="staging"
NEXT_PUBLIC_APP_URL="https://staging.hearthbutler.com"

# ===== 数据库配置（必需）=====
# PostgreSQL数据库连接字符串
#
# 推荐服务商：
# - Supabase: https://supabase.com (免费额度充足)
# - Railway: https://railway.app (免费额度500小时/月)
# - Neon: https://neon.tech (免费分支数据库)
# - PlanetScale: https://planetscale.com (免费额度1个数据库)
#
# 格式: postgresql://用户名:密码@主机:端口/数据库名
# 示例: postgresql://postgres:mypassword@db.abc123.supabase.co:5432/postgres
DATABASE_URL="postgresql://user:password@staging-db-host:5432/hearthbutler_staging"

# ===== 认证配置（必需）=====
# NextAuth.js密钥 - 必须至少32个字符的强随机字符串
#
# 🔑 生成新密钥命令：
# openssl rand -base64 32
#
# ⚠️ 重要：Staging环境必须使用与生产环境不同的密钥！
NEXTAUTH_SECRET="your-staging-secret-key-min-32-chars-replace-me"

# NextAuth URL - 您的Staging环境域名
# 如果使用Vercel，这将是 https://your-project-name.vercel.app
# 或您的自定义staging域名
NEXTAUTH_URL="https://staging.hearthbutler.com"

# ===== OAuth配置（可选）=====
# Google OAuth认证
# 创建OAuth凭据：https://console.cloud.google.com/apis/credentials
#
# 📝 配置提示：
# 1. 创建新的OAuth 2.0客户端ID
# 2. 授权重定向URI：https://staging.hearthbutler.com/api/auth/callback/google
# 3. 可以使用与生产环境相同的凭据，或创建staging专用凭据
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""

# GitHub OAuth (可选)
# https://github.com/settings/developers
GITHUB_CLIENT_ID=""
GITHUB_CLIENT_SECRET=""

# ===== Redis缓存配置（强烈推荐）=====
# Upstash Redis - 推荐用于Vercel部署
# 免费注册：https://console.upstash.com
#
# 🚀 Upstash优势：
# - 与Vercel完美集成，边缘网络支持
# - 免费额度：10,000命令/天
# - HTTP REST API，无需持久连接
# - 创建数据库后在"Details"页面找到REST API配置
UPSTASH_REDIS_REST_URL="https://your-redis-instance.upstash.io"
UPSTASH_REDIS_REST_TOKEN="your-upstash-redis-token"

# 传统Redis连接（可选，如果不使用Upstash）
# REDIS_URL="redis://default:password@redis-host:6379"

# ===== 外部API配置（功能可选）=====
# OpenAI API - AI功能（营养建议、食谱生成等）
# 获取密钥：https://platform.openai.com/api-keys
#
# 💰 成本控制建议：
# - Staging环境可以设置较低的使用限额
# - 使用gpt-3.5-turbo而非gpt-4降低成本
# - 考虑共享开发/staging密钥
OPENAI_API_KEY=""

# USDA食品数据API - 营养数据查询
# 免费注册：https://fdc.nal.usda.gov/api-key-signup.html
# 免费额度：1,000请求/小时
USDA_API_KEY=""

# OpenRouter API（可选，作为OpenAI备用）
# https://openrouter.ai/keys
OPENROUTER_API_KEY=""

# ===== 文件存储配置（可选）=====
# AWS S3或兼容服务（用户头像、图片上传等）
#
# 💡 Staging建议：
# - 可以使用单独的S3 bucket避免污染生产数据
# - 或使用Vercel Blob存储（https://vercel.com/docs/storage/vercel-blob）
AWS_ACCESS_KEY_ID=""
AWS_SECRET_ACCESS_KEY=""
AWS_S3_BUCKET="hearthbutler-staging"
AWS_REGION="us-east-1"

# Vercel Blob存储（推荐用于Vercel部署）
# BLOB_READ_WRITE_TOKEN=""

# ===== CORS和安全配置（必需）=====
# 允许的跨域来源
# 格式：逗号分隔的域名列表（不要在结尾加斜杠）
NEXT_PUBLIC_ALLOWED_ORIGINS="https://staging.hearthbutler.com"

# 内容安全策略配置（可选，已在next.config.js中配置）
# CSP_REPORT_URI="https://your-csp-report-endpoint.com/report"

# ===== 监控和错误追踪（强烈推荐）=====
# Sentry错误追踪
# 免费注册：https://sentry.io/signup/
#
# 📊 Staging监控建议：
# 1. 创建单独的Sentry项目用于Staging
# 2. 设置较高的采样率（1.0）捕获所有错误
# 3. 配置告警通知到开发团队
#
# 获取DSN：Sentry项目设置 > Client Keys (DSN)
NEXT_PUBLIC_SENTRY_DSN=""

# Sentry环境标识
SENTRY_ENVIRONMENT="staging"

# 错误采样率（0.0 - 1.0）
# Staging建议使用1.0捕获所有错误
SENTRY_SAMPLE_RATE="1.0"

# 性能追踪采样率（0.0 - 1.0）
# 控制性能监控数据采集比例
SENTRY_TRACES_SAMPLE_RATE="0.5"

# ===== 分析和性能监控（可选）=====
# Vercel Analytics（Vercel部署自动启用）
NEXT_PUBLIC_VERCEL_ANALYTICS_ID=""

# Google Analytics
NEXT_PUBLIC_GA_MEASUREMENT_ID=""

# ===== 功能开关（可选）=====
# 用于控制Staging环境中的功能启用/禁用
#
# 💡 Staging策略：
# - 核心功能应该启用以便测试
# - 非核心或实验性功能可以禁用减少复杂度
# - 可以用于A/B测试和灰度发布

# 启用AI功能（需要OPENAI_API_KEY）
ENABLE_AI_FEATURES="true"

# 启用电商集成
ENABLE_ECOMMERCE="false"

# 启用社交分享
ENABLE_SOCIAL_SHARING="true"

# 启用高级营养分析
ENABLE_ADVANCED_NUTRITION="true"

# 调试模式（在Staging环境启用详细日志）
DEBUG_MODE="true"

# ===== 数据库和缓存配置（高级）=====
# 数据库连接池配置
DATABASE_POOL_MIN="2"
DATABASE_POOL_MAX="10"

# 缓存TTL配置（秒）
CACHE_TTL_SHORT="300"      # 5分钟
CACHE_TTL_MEDIUM="3600"    # 1小时
CACHE_TTL_LONG="86400"     # 24小时

# ===== 日志配置（可选）=====
# 日志级别：debug | info | warn | error
LOG_LEVEL="debug"

# 结构化日志格式
LOG_FORMAT="json"

# ===== 速率限制配置（可选）=====
# API速率限制（请求/分钟）
# Staging环境可以设置较宽松的限制
RATE_LIMIT_PER_MINUTE="100"

# ===== Webhook配置（可选）=====
# 如果应用需要接收外部webhook
WEBHOOK_SECRET=""

# ===== 邮件服务配置（可选）=====
# 用于发送通知邮件、密码重置等
#
# 推荐服务商：
# - SendGrid: https://sendgrid.com (免费100封/天)
# - Resend: https://resend.com (免费3,000封/月)
# - Postmark: https://postmarkapp.com (免费100封/月)
EMAIL_FROM="noreply@staging.hearthbutler.com"
EMAIL_PROVIDER="sendgrid"  # sendgrid | resend | smtp
SENDGRID_API_KEY=""
# RESEND_API_KEY=""
# SMTP_HOST=""
# SMTP_PORT="587"
# SMTP_USER=""
# SMTP_PASSWORD=""

# ========================================
# 📝 配置检查清单
# ========================================
#
# 部署前请确认：
# ✅ DATABASE_URL - 已配置并可连接
# ✅ NEXTAUTH_SECRET - 已生成强随机密钥（32+字符）
# ✅ NEXTAUTH_URL - 正确的staging域名
# ✅ UPSTASH_REDIS_REST_URL - Redis缓存已配置
# ✅ UPSTASH_REDIS_REST_TOKEN - Redis令牌正确
# ✅ NEXT_PUBLIC_ALLOWED_ORIGINS - CORS配置正确
# ⚠️  OpenAI/USDA API密钥 - 可选但推荐配置
# ⚠️  Sentry DSN - 强烈推荐用于错误监控
#
# ========================================
# 🚀 快速开始指南
# ========================================
#
# 1. 复制此文件：
#    cp .env.staging.example .env.staging
#
# 2. 填写必需的环境变量
#
# 3. 生成NEXTAUTH_SECRET：
#    openssl rand -base64 32
#
# 4. 在Vercel中配置环境变量：
#    - 进入项目 > Settings > Environment Variables
#    - 选择 "Preview" 环境
#    - 逐个添加上述变量
#
# 5. 触发部署或手动部署：
#    git push origin main
#
# 6. 运行数据库迁移（部署后执行）：
#    npx prisma migrate deploy
#
# ========================================
# 📚 相关文档
# ========================================
# - Staging部署清单：STAGING_DEPLOYMENT_CHECKLIST.md
# - 部署指南：DEPLOYMENT_GUIDE.md
# - OpenSpec实施报告：OPENSPEC_IMPLEMENTATION_REPORT.md
# ========================================
